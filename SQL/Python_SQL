import pymysql

# Káº¿t ná»‘i tá»›i MySQL
conn = pymysql.connect(
    host="localhost",
    user="root",
    password="123456",
    database="NCKH"
)

cursor = conn.cursor()

# ğŸŸ¢ 1. Gá»i Stored Procedure Ä‘á»ƒ láº¥y toÃ n bá»™ nhÃ¢n viÃªn
cursor.callproc("Get_Employees")
rows = cursor.fetchall()
print("\nğŸ“Œ Danh sÃ¡ch nhÃ¢n viÃªn:")
for row in rows:
    print(row)

# ğŸŸ¢ 2. Gá»i Stored Procedure Ä‘á»ƒ láº¥y thÃ´ng tin nhÃ¢n viÃªn theo ID
employee_id = "E002"
cursor.callproc("Get_Employees_ID", (employee_id,))
rows = cursor.fetchall()
print(f"\nğŸ“Œ ThÃ´ng tin nhÃ¢n viÃªn cÃ³ ID {employee_id}:")
for row in rows:
    print(row)

# ğŸŸ¢ 3. Gá»i Stored Procedure Ä‘á»ƒ chÃ¨n nhÃ¢n viÃªn má»›i
new_employee = ("E007", "Nguyen Van A", "D001", "Developer", "2024-03-15")
cursor.callproc("Insert_Employees", new_employee)
conn.commit()
print("\nâœ… ÄÃ£ thÃªm nhÃ¢n viÃªn má»›i!")

# ğŸŸ¢ 4. Gá»i Stored Procedure Ä‘á»ƒ xÃ³a nhÃ¢n viÃªn theo ID
delete_id = "E006"
cursor.callproc("Delete_Employees", (delete_id,))
conn.commit()
print(f"\nâœ… ÄÃ£ xÃ³a nhÃ¢n viÃªn cÃ³ ID {delete_id}")

# ğŸŸ¢ 5. Gá»i Function Ä‘á»ƒ Ä‘áº¿m sá»‘ nhÃ¢n viÃªn
cursor.execute("SELECT CountOfEmp()")
employee_count = cursor.fetchone()[0]
print(f"\nğŸ“Œ Sá»‘ lÆ°á»£ng nhÃ¢n viÃªn hiá»‡n táº¡i: {employee_count}")

# ğŸŸ¢ 6. Gá»i Stored Procedure láº¥y danh sÃ¡ch cháº¥m cÃ´ng theo thÃ¡ng
month = 3
year = 2024
cursor.callproc("Get_Attendance_By_Month", (month, year))
rows = cursor.fetchall()
print(f"\nğŸ“Œ Cháº¥m cÃ´ng thÃ¡ng {month}/{year}:")
for row in rows:
    print(row)

# ÄÃ³ng káº¿t ná»‘i
cursor.close()
conn.close()
